<div class="fade-in">
  <!-- Page Header -->
  <div class="professional-card">
    <div class="card-header-custom">
      <h2 class="display-5 mb-3">üìã My Task Dashboard</h2>
      <p class="lead mb-0">Track your progress and stay organized with your personal productivity center</p>
    </div>
  </div>

  <!-- Stats Overview -->
  <div class="row g-4 mb-4" *ngIf="todos.length > 0">
    <div class="col-md-4">
      <div class="stats-card">
        <span class="stats-number">{{ todos.length }}</span>
        <span class="stats-label">Total Tasks</span>
      </div>
    </div>
    <div class="col-md-4">
      <div class="stats-card">
        <span class="stats-number text-success">{{ getCompletedCount() }}</span>
        <span class="stats-label">Completed</span>
      </div>
    </div>
    <div class="col-md-4">
      <div class="stats-card">
        <span class="stats-number text-warning">{{ getPendingCount() }}</span>
        <span class="stats-label">Pending</span>
      </div>
    </div>
  </div>

  <!-- Progress Bar -->
  <div class="professional-card mb-4" *ngIf="todos.length > 0">
    <div class="card-body p-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h6 class="mb-0 text-primary-blue fw-semibold">Overall Progress</h6>
        <span class="badge bg-gradient-primary">{{ getProgressPercentage() }}% Complete</span>
      </div>
      <div class="progress" style="height: 8px;">
        <div class="progress-bar bg-gradient bg-success" 
             [style.width.%]="getProgressPercentage()"
             role="progressbar"
             [attr.aria-valuenow]="getProgressPercentage()"
             aria-valuemin="0" 
             aria-valuemax="100">
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="todos.length === 0" class="professional-card text-center">
    <div class="card-body p-5">
      <div class="mb-4">
        <div class="d-inline-flex align-items-center justify-content-center bg-light rounded-circle mb-3" 
             style="width: 120px; height: 120px;">
          <i class="bi bi-list-ul text-muted" style="font-size: 3rem;"></i>
        </div>
      </div>
      <h3 class="text-muted mb-3">No tasks yet! üåü</h3>
      <p class="text-muted mb-4 lead">Start your productivity journey by creating your first task. Organize your day and achieve your goals with ease.</p>
      <a routerLink="/add" class="btn btn-primary-blue btn-professional btn-lg">
        <i class="bi bi-plus-circle"></i>
        Create Your First Task
      </a>
    </div>
  </div>

  <!-- Tasks Section -->
  <div *ngIf="todos.length > 0">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h4 class="text-primary-blue mb-0 fw-semibold">
        <i class="bi bi-list-check me-2"></i>
        Your Tasks
      </h4>
      <a routerLink="/add" class="btn btn-primary-blue btn-professional">
        <i class="bi bi-plus-circle"></i>
        Add New Task
      </a>
    </div>

    <!-- Filter Options -->
    <div class="professional-card mb-4">
      <div class="card-body p-3">
        <div class="row align-items-center">
          <div class="col-md-6">
            <div class="btn-group" role="group">
              <input type="radio" class="btn-check" name="filter" id="all" (change)="setFilter('all')" [checked]="currentFilter === 'all'">
              <label class="btn btn-outline-primary" for="all">All Tasks</label>

              <input type="radio" class="btn-check" name="filter" id="pending" (change)="setFilter('pending')" [checked]="currentFilter === 'pending'">
              <label class="btn btn-outline-warning" for="pending">Pending</label>

              <input type="radio" class="btn-check" name="filter" id="completed" (change)="setFilter('completed')" [checked]="currentFilter === 'completed'">
              <label class="btn btn-outline-success" for="completed">Completed</label>
            </div>
          </div>
          <div class="col-md-6 text-end">
            <small class="text-muted">
              Showing {{ getFilteredTodos().length }} of {{ todos.length }} tasks
            </small>
          </div>
        </div>
      </div>
    </div>

    <!-- Tasks Grid -->
    <div class="row g-4">
      <div *ngFor="let todo of getFilteredTodos(); trackBy: trackByTodoId" class="col-xl-6 col-lg-6">
        <div class="task-card" [class.completed]="todo.done">
          <!-- Task Header -->
          <div class="d-flex align-items-start mb-3">
            <div class="me-3 mt-1">
              <button class="btn p-0 border-0 bg-transparent" (click)="toggleDone(todo.id)">
                <i [class]="todo.done ? 'bi bi-check-circle-fill text-success' : 'bi bi-circle text-muted'" 
                   style="font-size: 1.8rem; transition: all 0.2s;"></i>
              </button>
            </div>
            <div class="flex-grow-1">
              <h6 class="mb-2 fw-semibold" 
                  [class.text-decoration-line-through]="todo.done"
                  [class.text-muted]="todo.done">
                {{ todo.title }}
              </h6>
              <div class="d-flex align-items-center gap-2">
                <span class="badge rounded-pill" 
                      [class.bg-success]="todo.done"
                      [class.bg-warning]="!todo.done">
                  {{ todo.done ? '‚úÖ Completed' : '‚è≥ Pending' }}
                </span>
                <small class="text-muted">ID: #{{ todo.id }}</small>
              </div>
            </div>
          </div>
          
          <!-- Action Buttons -->
          <div class="d-grid gap-2">
            <button 
              class="btn btn-professional"
              [class.btn-outline-custom]="todo.done"
              [class.btn-success-green]="!todo.done"
              (click)="toggleDone(todo.id)">
              <i [class]="todo.done ? 'bi bi-arrow-counterclockwise' : 'bi bi-check-lg'"></i>
              {{ todo.done ? 'Mark as Pending' : 'Mark as Done' }}
            </button>
            
            <div class="btn-group" role="group">
              <button 
                class="btn btn-purple btn-professional flex-fill" 
                [routerLink]="['/edit', todo.id]">
                <i class="bi bi-pencil"></i>
                Edit
              </button>
              <button 
                class="btn btn-danger-custom btn-professional flex-fill" 
                (click)="confirmDelete(todo)"
                [attr.data-bs-toggle]="'modal'"
                [attr.data-bs-target]="'#deleteModal'">
                <i class="bi bi-trash"></i>
                Delete
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions Card -->
  <div *ngIf="todos.length > 0" class="professional-card mt-5">
    <div class="card-body p-4">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h5 class="text-primary-blue mb-3 fw-semibold">
            <i class="bi bi-lightning"></i>
            Quick Actions
          </h5>
          <p class="text-muted mb-3">Manage your tasks efficiently with these productivity tools</p>
          <div class="d-flex gap-3 flex-wrap">
            <a routerLink="/add" class="btn btn-primary-blue btn-professional">
              <i class="bi bi-plus-circle"></i>
              Add Task
            </a>
            <button class="btn btn-outline-custom btn-professional" (click)="markAllCompleted()" *ngIf="getPendingCount() > 0">
              <i class="bi bi-check-all"></i>
              Complete All
            </button>
            <a routerLink="/" class="btn btn-outline-custom btn-professional">
              <i class="bi bi-house"></i>
              Home
            </a>
          </div>
        </div>
        <div class="col-md-4 text-center">
          <div class="d-inline-flex align-items-center justify-content-center bg-gradient-primary rounded-circle" 
               style="width: 80px; height: 80px;">
            <i class="bi bi-graph-up text-white" style="font-size: 2rem;"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow">
      <div class="modal-header border-0 pb-0">
        <h5 class="modal-title text-danger">
          <i class="bi bi-exclamation-triangle me-2"></i>
          Confirm Delete
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p class="mb-0">Are you sure you want to delete this task?</p>
        <div class="alert alert-light mt-3 mb-0" *ngIf="taskToDelete">
          <strong>"{{ taskToDelete.title }}"</strong>
        </div>
      </div>
      <div class="modal-footer border-0 pt-0">
        <button type="button" class="btn btn-outline-custom btn-professional" data-bs-dismiss="modal">
          Cancel
        </button>
        <button type="button" class="btn btn-danger-custom btn-professional" 
                (click)="deleteTodo(taskToDelete?.id)" 
                data-bs-dismiss="modal">
          <i class="bi bi-trash"></i>
          Delete Task
        </button>
      </div>
    </div>
  </div>
</div>